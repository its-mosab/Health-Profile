<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puberty Calculator</title>
</head>
<body>
    <header>
        <h1>HealthProfiler</h1>
        <nav>
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="../BMI Calculator/BMI-Calculator.html">BMI Calculator</a></li>
                <li><a href="../Calorie/Calorie.html">Calorie Calculator</a></li>
                <li><a href="../Weight Calculator/Weight-Calculator.html">Weight Calculator</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
        <h1>Puberty Calculator</h1>
        <form id="pubertyCalculator">
            <div class="input-group">
                <label for="ageYears">Age (Years):</label>
                <input type="number" id="ageYears" min="0" required>
                <label for="ageMonths">Age (Months):</label>
                <input type="number" id="ageMonths" min="0" max="11" required>
            </div>
            <div class="input-group">
                <label for="height">Height (cm):</label>
                <input type="number" id="height" min="0" required>
            </div>
            <div class="input-group">
                <label for="weight">Weight (kg):</label>
                <input type="number" id="weight" min="0" required>
            </div>
            <div class="input-group">
                <label for="gender">Gender:</label>
                <select id="gender" required>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                </select>
            </div>
            <button type="submit">Calculate</button>
            <button id="moreDetailsBtn" type="button">More Details</button>
        </form>
        
        <div id="results"></div>
        <div id="moreDetails"></div>
        <canvas id="heightChart" width="400" height="200"></canvas>
        <canvas id="weightChart" width="400" height="200"></canvas>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="HeightData.js"></script>
    <script src="WeightData.js"></script>
    <script>
document.getElementById('pubertyCalculator').addEventListener('submit', function(event) {
event.preventDefault();
const ageYears = +document.getElementById('ageYears').value;
const ageMonths = +document.getElementById('ageMonths').value;
const height = +document.getElementById('height').value;
const weight = +document.getElementById('weight').value;
const gender = document.getElementById('gender').value;
let totalMonths = ageYears * 12 + ageMonths;
totalMonths = Math.min(totalMonths, 240);
const heightAt240 = calculate(totalMonths, height, gender, 240, 'height');
const weightAt240 = calculate(totalMonths, weight, gender, 240, 'weight');
document.getElementById('results').innerHTML = `<h2>Main Results</h2><p>Height: ${heightAt240.toFixed(2)} cm</p><p>Weight: ${weightAt240.toFixed(2)} kg</p>`;
document.getElementById('moreDetailsBtn').style.display = 'block'; // Show the More Details button
document.getElementById('moreDetails').innerHTML = '';

if (document.getElementById('moreDetails').classList.contains('show')) {
const labels = [];
const heightData = [];
const weightData = [];
for (let targetAgeYears = 2; targetAgeYears <= 20; targetAgeYears++) {
const targetAgeMonths = targetAgeYears * 12;
labels.push(`Age ${targetAgeYears}`);
const heightAtTarget = calculate(totalMonths, height, gender, targetAgeMonths, 'height');
heightData.push(heightAtTarget.toFixed(2));
const weightAtTarget = calculate(totalMonths, weight, gender, targetAgeMonths, 'weight');
weightData.push(weightAtTarget.toFixed(2));
}
updateChart('heightChart', labels, heightData);
updateChart('weightChart', labels, weightData);
}
});

document.getElementById('moreDetailsBtn').addEventListener('click', function() {
const moreDetails = document.getElementById('moreDetails');
const isVisible = moreDetails.classList.toggle('show');
if (isVisible) {
const ageYears = +document.getElementById('ageYears').value;
const ageMonths = +document.getElementById('ageMonths').value;
const height = +document.getElementById('height').value;
const weight = +document.getElementById('weight').value;
let totalMonths = ageYears * 12 + ageMonths;
totalMonths = Math.min(totalMonths, 240);
const labels = [];
const heightData = [];
const weightData = [];
for (let targetAgeYears = 2; targetAgeYears <= 20; targetAgeYears++) {
const targetAgeMonths = targetAgeYears * 12;
labels.push(`Age ${targetAgeYears}`);
const heightAtTarget = calculate(totalMonths, height, gender, targetAgeMonths, 'height');
heightData.push(heightAtTarget.toFixed(2));
const weightAtTarget = calculate(totalMonths, weight, gender, targetAgeMonths, 'weight');
weightData.push(weightAtTarget.toFixed(2));
}
generateChart(heightData, labels, 'Height (cm)', 'heightChart');
generateChart(weightData, labels, 'Weight (kg)', 'weightChart');
}
});

function calculate(ageMonths, value, gender, targetAgeMonths, type) {
const data = (gender === 'male') ? (type === 'height' ? maleHeightData : maleWeightData) : (type === 'height' ? femaleHeightData : femaleWeightData);
const { l, m, s, p, me, c } = data[ageMonths];
const z = ((value / (type === 'height' ? m : me)) ** (type === 'height' ? l : p) - 1) / ((type === 'height' ? l : p) * (type === 'height' ? s : c));
const { l: lt, m: mt, s: st, p: pt, me: met, c: ct } = data[targetAgeMonths];
return (type === 'height' ? mt : met) * (1 + (type === 'height' ? lt : pt) * (type === 'height' ? st : ct) * z) ** (1 / (type === 'height' ? lt : pt));
}

function generateChart(data, labels, title, canvasId) {
const ctx = document.getElementById(canvasId).getContext('2d');
new Chart(ctx, {
type: 'line',
data: {
labels: labels,
datasets: [{
label: title,
data: data,
backgroundColor: 'rgba(0, 123, 255, 0.5)',
borderColor: 'rgba(0, 123, 255, 1)',
borderWidth: 1
}]
},
options: {
scales: {
y: {
beginAtZero: true
}
}
}
});
}

function updateChart(canvasId, labels, data) {
const chart = Chart.getChart(canvasId);
chart.data.labels = labels;
chart.data.datasets[0].data = data;
chart.update();
}
    </script>
</body>
</html>